(self.webpackChunknw_idolfest_website=self.webpackChunknw_idolfest_website||[]).push([[485],{66900:function(e,t,n){"use strict";var r=n(67294),a=n(12112),s=n(8266),c=(0,a.Z)(s.Z)({textAlign:"center",paddingBottom:"1em"});t.Z=function(e){var t=e.children;return r.createElement(c,null,t)}},81712:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return L}});var r,a,s,c=n(67294),i=n(25444),o=n(92207),u=n(15583),l=n(86273),p=n(45954),d=n(66900),f=n(41788),m=n(92137),y=n(87757),h=n.n(y);r="sq0idp-OyXssltwNQblNk9NOxKJ4w",a="L4RPAVMCK1MD7",s="https://9lr67gx861.execute-api.us-east-1.amazonaws.com/reg2-prod";function v(e){return g.apply(this,arguments)}function g(){return(g=(0,m.Z)(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.card();case 2:return n=e.sent,e.next=5,n.attach("#card-container");case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return e.paymentRequest({countryCode:"US",currencyCode:"USD",total:{amount:(t/100).toString(),label:"Total"}})}function E(e,t){return w.apply(this,arguments)}function w(){return(w=(0,m.Z)(h().mark((function e(t,n){var r,a;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=b(t,n),e.next=3,t.googlePay(r);case 3:return a=e.sent,e.next=6,a.attach("#google-pay-button");case 6:return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t,n){return k.apply(this,arguments)}function k(){return(k=(0,m.Z)(h().mark((function e(t,n,r){var c,i,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=JSON.stringify({locationId:a,sourceId:t,guid:n,amount:r}),e.next=3,fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:c});case 3:if(!(i=e.sent).ok){e.next=6;break}return e.abrupt("return",i.json());case 6:return e.next=8,i.text();case 8:throw o=e.sent,new Error(o);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return Z.apply(this,arguments)}function Z(){return(Z=(0,m.Z)(h().mark((function e(t){var n,r;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.tokenize();case 2:if("OK"!==(n=e.sent).status){e.next=7;break}return e.abrupt("return",n.token);case 7:throw r="Tokenization failed with status: "+n.status,n.errors&&(r+=" and errors: "+JSON.stringify(n.errors)),new Error(r);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,t){var n=document.getElementById("payment-status-container"),r=document.getElementById("receipt-container");"SUCCESS"===e?(n.classList.remove("is-failure"),n.classList.add("is-success"),r.style.visibility="visible",r.style.visibility="visible",r.innerHTML="Thank you for purchasing a NWIF badge! Please save <a href="+t.payment.receiptUrl+' target="_blank">your receipt</a> before closing this page.<br /><br /><a href="https://discord.gg/h5yJbXgTgE" target="_blank">Join our Discord</a> and claim your role now!<br /><br />'):(n.classList.remove("is-success"),n.classList.add("is-failure")),n.style.visibility="visible"}function I(e){for(var t=0;t<e.length;t++)e[t].src=""}var P=function(e){function t(){return e.apply(this,arguments)||this}(0,f.Z)(t,e);var n=t.prototype;return n.componentDidMount=function(){var e=(0,m.Z)(h().mark((function e(){var t,n,s,c,i,o,u,l,p;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=function(){return(l=(0,m.Z)(h().mark((function e(r,a){var s,c;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,p.disabled=!0,e.next=5,S(a);case 5:return s=e.sent,e.next=8,x(s,t,n);case 8:C("SUCCESS",c=e.sent),console.debug("Payment Success",c);try{I(document.getElementsByTagName("iframe"))}finally{}e.next=19;break;case 14:e.prev=14,e.t0=e.catch(1),p.disabled=!1,C("FAILURE"),console.error(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[1,14]])})))).apply(this,arguments)},u=function(e,t){return l.apply(this,arguments)},window.Square){e.next=4;break}throw new Error("Square.js failed to load properly");case 4:t=this.props.guid,n=this.props.amount,e.prev=6,s=window.Square.payments(r,a),e.next=16;break;case 10:return e.prev=10,e.t0=e.catch(6),(c=document.getElementById("payment-status-container")).className="missing-credentials",c.style.visibility="visible",e.abrupt("return");case 16:return e.prev=16,e.next=19,v(s);case 19:i=e.sent,e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(16),console.error("Initializing Card failed",e.t1),e.abrupt("return");case 26:return e.prev=26,e.next=29,E(s,n);case 29:o=e.sent,e.next=35;break;case 32:e.prev=32,e.t2=e.catch(26),console.error("Initializing Google Pay failed",e.t2);case 35:(p=document.getElementById("card-button")).addEventListener("click",function(){var e=(0,m.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,u(t,i);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),void 0!==o&&document.getElementById("google-pay-button").addEventListener("click",function(){var e=(0,m.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t,o);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.applePay&&document.getElementById("apple-pay-button").addEventListener("click",function(){var e=(0,m.Z)(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u(t,this.applePay);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}());case 39:case"end":return e.stop()}}),e,this,[[6,10],[16,22],[26,32]])})));return function(){return e.apply(this,arguments)}}(),n.render=function(){return c.createElement("div",null,c.createElement("form",{id:"payment-form"},c.createElement("div",{id:"google-pay-button"}),c.createElement("div",{id:"card-container"}),c.createElement("button",{id:"card-button",type:"button"},"Pay $",this.props.amount/100)),c.createElement("div",{id:"payment-status-container"}),c.createElement("div",{id:"receipt-container"}))},t}(c.Component),L=function(e){var t=e.location,n=(0,c.useState)(null),r=n[0],a=n[1];(0,c.useEffect)((function(){new Promise((function(e,t){var n=document.createElement("script");n.src="https://web.squarecdn.com/v1/square.js",n.crossorigin="anonymous",n.onload=function(){e()},n.onerror=function(){t("Failed to load "+n.src)},document.getElementsByTagName("head")[0].appendChild(n)})).then((function(){a("SUCCESS")})).catch((function(){return a("ERROR")}))}),[]);var s=new URLSearchParams(t.search),f=s.get("guid"),m=s.get("amount"),y=s.get("tax"),h=s.get("badge_type");return c.createElement(o.Z,null,c.createElement(u.Z,{title:"Payment"}),c.createElement(p.Z,{title:"Payment"}),c.createElement(l.Z,{suppressHydrationWarning:!0},c.createElement(d.Z,null,c.createElement("p",null,"Finish purchasing your ",h," below."),c.createElement("p",null,"Total: $",(m-y)/100," ",y>0?c.createElement("span",null,"+ $",(y/100).toFixed(2)," tax"):null)),"ERROR"===r&&"Failed to load SquareSDK. Please refresh the page.","SUCCESS"===r&&c.createElement(P,{guid:f,amount:m}),c.createElement(d.Z,null,c.createElement("small",null,"If you encounter errors, please ",c.createElement(i.Link,{to:"/contact"},"contact us")," and provide reference ID ",f,"."),c.createElement("br",null),c.createElement("small",null,"Payment processing is provided by Square. NWIF never handles or stores your credit card details."))))}}}]);
//# sourceMappingURL=component---src-pages-payment-js-136861374a6622ef6bc8.js.map